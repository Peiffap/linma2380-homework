syms x
A1 = [10.5 -9.5 -6.5 4.5 ; 13.0 -12.0 -7.5 5.5 ; 9.0 -6.0 -6.0 2.0 ; 13.0 -10.0 -7.5 3.5];
A2 = [14.5 -13.5 -8.5 6.5 ; 16.0 -15.0 -9.0 7.0 ; 13.0 -10.0 -8.0 4.0 ; 16.0 -13.0 -9.0 5.0];
A3 = [16.0 -15.0 -10.0 8.0 ; 18.0 -17.0 -11.0 9.0 ; 14.0 -11.0 -9.0 5.0 ; 18.0 -15.0 -11.0 7.0];

mA1 = x*eye(4)-A1;
S1 = smithForm(mA1,x)
factor(S1(4,4))

mA2 = x*eye(4)-A2;
S2 = smithForm(mA2,x)
factor(S2(4,4))

mA3 = x*eye(4)-A3;
S3 = smithForm(mA3,x)
factor(S3(4,4))